
## CAP
任何一个分布式系统都无法同时满足一致性（Consistency）、可用性（Availability）和分区容错性（Partition tolerance），最多只能同时满足两项。

强一致性:在分布式系统同一份数据有多副本的情况下,对于数据的操作效果和只有单份数据一样。
可用性:客户端在任何时刻对数据的读/写操作都应该保证在时限内完成。
分区容忍性:当分布式系统出现网络分区,不同分区间的机器无法进行网络通信时,系统仍然能够继续工作。

1. `一个更新提交给节点，如果等所有节点一致的确认（保C），那么这段时间A就没了`;
2. `如果为了及时回应请求（保A），那么就需要在不知道其他节点是否已经一致的情况下进行操作，那么C就没了`；
3. `一旦有网络这个不可靠的因素介入，那么A和C就无法同时满足，所以只能放弃网络，P就没了`
当前分布式系统无法解决P的问题，因此总是在AC中进行取舍，其中A要通过业务分析尽量提高可用性，C一般采用最终一致代替强一致

###Paxos，BASE，CAP，区别
|Base|CAP|Paxos|
|---|---|---|
|1. Basically Available（基本可用）|1. 可用性（Availability）||
|2.Soft state（软状态）|2. 分区容错性（Partition tolerance）||
|3.Eventually consistent（最终一致性）三个短语的简写|3. 一致性（Consistency）||
|基本可用：响应时间稍长，某些非核心功能暂时不能使用|
|软状态：允许系统中的数据存在中间状态，并且认为盖中间状态不会影响系统整体可用性；也就是允许不同节点的数据存在暂时的不同步，或者说同步过程存在一定延时|
|最终一致：经过一段时间的同步后，最终能够达到一致的状态，最终结果符合预期|

### CAP是一种理论，告诉我们实际能够做到的上限。
### BASE是在考虑CAP之后的针对实际情况进行的妥协，针对CAP中一致性和可用性权衡的结果。
### Paxos通过两次提案，和对提案的共识，保障了操作的互斥性以及时序性。
根据第一次提案收到的反馈得知自己是否获得了第二次提案的资格，如果有资格，那么提交第一次提案反馈里的最后一个大多数认可的提案（可能不是自己的）。


#### 软状态的一些心得：
比如转账操作，不是直接修改余额，而是把没办法及时提交的需要修改余额的操作都记下来，在允许的范围内积累这些修改，然后在一定条件下把这些操作造成的影响整理出来，更新一下余额。这样也符合最终一致性。

#### 基本可用：
非功能性的一些退化：响应时间，样式等；
功能性的暂时关闭：对那些无法保证质量，同时又可能造成不一致的用户功能进行暂时关闭的处理


### 一致性：
强一致-总是能读到最近一次写的值；

弱一致性-可能读到旧(Stale)的值;

最终一致性-在一段时间窗口内可能读到旧的值，最终会读到新的值。