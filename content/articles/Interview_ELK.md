### 12.solr or es 两个要了解一个，lucence原理，核心是倒排索引
在正向索引中，文档占据了中心的位置，每个文档指向了一个它所包含的索引项的序列。也就是说文档指向了它包含的那些单词，而反向索引则是单词指向了包含它的文档，很容易看到这个反向的关系。

根据文档内容在索引中的位置保存文档ID

ID组成的Posting List 增量压缩
索引成分在文档中的位置用Roar Bitmap存储

设计一个分布式日志系统，用什么工具比较合适，比如ELK
elk + kafka + zookeeper

## ELK
`Elastic Stack（旧称ELK Stack）`
分布式实时文件存储，并将每一个字段都编入索引，使其可以被搜索。
实时分析的分布式搜索引擎。
可以扩展到上百台服务器，处理PB级别的结构化或非结构化数据。

### 文件存储
Json格式的文档
一个索引相当于关系型的一个数据库（index）
一个类型相当于关系型的一个表（type）
一个文档相当于关系型的一行（documents）
一个字段相当于关系型的一列（fields）

### 索引
Elasticsearch分别为每个field都建立了一个倒排索引
倒排索引比B-树快
将多个值作为一个数组通过连续区间存放 ——叶子上存放的是一串有序的值组成的List（Posting List）
List里存放的是该按该索引排序下，排序区间内的document的id

### Term Index
通过前缀保存offset，相当于简历范围查找的树

### Posting List的压缩
存大数是比较耗空间的，而且List里的数是有序递增的
那么只存储两两之间的差，就可以节省很多空间，只是在读取的时候要运算还原

### Roaring bitmaps
划分2^16 大小的块，list里的数按照<商，余数>的算法算出应该对应在哪个块的哪个位表示

### 联合索引
使用跳表 
把相等的数挑出来，做第一层
然后依次向下，把相等的数挑出来放在这一层

### 虚拟化隔离级别
1. 环境隔离(nix-env)
nix-env
2. 进程隔离(nix-container)
Docker
3. 资源隔离(nixos virtualbox)
虚拟机